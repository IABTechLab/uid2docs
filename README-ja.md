# UID 2.0
[English](README.md) | 日本語

[UID 2.0 API Documentation](/api-ja/README.md)

## Introduction

アドレッサブル広告を利用することで、パブリッシャーや開発者は、モバイルアプリ、ストリーミングTV、ウェブ体験など、消費者が楽しめるコンテンツやサービスを提供することができます。このようなオープンインターネットの価値交換は、必ずしも消費者に理解されているわけではなく、また消費者に伝えられているわけでもありません。業界がサードパーティークッキーへの依存を減らす中、オープンインターネットにおける消費者の識別方法を改善する機会が訪れています。その解決策は、コンテンツ制作者と消費者の双方が、消費者データを透明に管理することで、エンゲージメントの機会を向上させることができる識別システムです。

Unified ID 2.0（UID2）は、ユーザーの透明性とプライバシーコントロールを備えた、PII（例えば、メールアドレスや電話番号）をベースにした決定性のある識別子です。UID2識別子は、パブリッシャーのウェブサイト、モバイルアプリ、CTVアプリのログイン体験を、プログラマティックなワークフローで収益化することを可能にします。UID2は、何層にもわたるセキュリティとプライバシー対策の恩恵を受け、オープンなインターネット上で安全に配信されます。UID2は、当初The Trade Deskによって構築・維持されていましたが、2021年半ばには、オープンソースのコード管理、ガバナンス、管理、システム運用を行う独立した組織に移管されます。UID2は非独占的な規格であり、広告主、パブリッシャー、DSP、SSP、SSO、CDP、CMP、IDプロバイダー、データプロバイダー、計測プロバイダーなど、広告エコシステム全体の構成員が行動規範を遵守している限り、アクセス可能です。

UID2の目標は、消費者の透明性とコントロールが確保されたオープンインターネット上の広告機会において、決定論的な識別を可能にすることです。UID2は、透明で相互運用可能なアプローチを利用することで、すべての構成員に協力的な枠組みを提供し、健全でオープンなインターネットを実現します。

### Guiding Principles

**Independent Government:** UID2は、公平な第三者機関によって管理され、2021年にはThe Trade Deskからの移行が予定されています。

**First-Party Relationships:** UID2により、広告主はオープンインターネット上でパブリッシャーのファーストパーティデータを容易に有効化することができます。

**Non-Proprietary (Universal) Standard:** UID2は、行動規範を遵守する広告エコシステムのすべての構成員がアクセス可能であり、個々の企業がアクセスを管理することはありません。これには、DSP、SSP、データプロバイダー、計測プロバイダー、アイデンティティサービスが含まれます。

**Open Source:** UID2のソースコードは、オープンソースのフレームワークによって透明化されます。

**Interoperable:** UID2 は、他の ID ソリューション（商用、プロプライエタリ）が UID2 をインテグレーションして提供することを可能にします。

**Secure and Encrypted Data:** UID2は、複数のレイヤーのセキュリティ、暗号化、および暗号化を利用して、PIIとユーザーデータを保護します。

**Transparency and Control:** 消費者は、自分のIDがどこで共有され、どのようなデータに関連付けられているかを理解することができます。また、消費者は、自分の同意や許可を取り消す権利を有しています。

### Technical Design Principles

**Accountability:** アクセスするメンバーには、独立した機関によって管理されている行動規範に従うことを求めます。

**Distributed Integration:** 複数の認定されたインテグレーションパスにより、パブリッシャー、広告主、データプロバイダーがUID2を生成するためのオプションが提供されます。

**Decentralized Storage:** 悪意のあるアクターをブロックするために、PIIからUID2へのマッピングを行う一元的な場所はありません。

**Lean Infrastructure:** インフラは軽く、安価に運用できます。

**Self-Reliant:** RTBデータのリアルタイム処理を外部サービスに依存しません。

## ID Forms

### UID2

UID2（raw UID2）は、検証可能で認証されたユーザーのPIIを入力として、一連のAPIまたはSDKを通じて作成される暗号化されていない英数字の識別子です。PIIの例としては、メールアドレスや電話番号などが挙げられます。

UID2は、広告主、データプロバイダー、DSPが保管することを目的としており、ビッドストリームで共有されることはありません。UID2 Token（またはUID2の暗号化された形式）は、ビッドストリームで共有されることに注意してください。

#### Technical Details

- UID2を作成するには、UID2 Operator APIまたはSDKインターフェースを使用します。

- UID2 Operatorは、ユーザーのPIIをSHA256でハッシュ化し、シークレットソルトを加えてUID2を生成します。

- 各UID2にはソルトバケット（salt bucket）が割り当てられています。バケットのソルトは、12ヶ月に1回ローテーションします。各ソルトバケットには、1～1,000,000の英数字が割り当てられています。

- UID2を保管している組織は、UID2のソルトバケットがいつローテーションしたかを知るために、UID2 Operator APIをモニターします。

### UID2 Token

raw UID2を暗号化するとUID2 Tokenが作成されますが、これは入札ストリームのワークフローでは一過性のものです。暗号法のノンスと暗号化を利用することで、UID2 Tokenは入札ストリームに入るたびに異なるものになります。これにより、UID2エコシステムの安全性が確保され、UID2以外の参加者がUID2 Tokenを使用してプロファイルを構築することを防ぎます。

UID2 Tokenは、パブリッシャーまたはパブリッシャーサービスプロバイダー（SSO など）が保管するように設計されています。SSOはUID2 Tokenをビッドストリームで渡し、DSPはビッドリクエスト時に復号します。

#### Technical Details

- 暗号法のノンスが生成され、UID2に付加され、暗号化されてUID2 Tokenが生成されます。

  - ノンス（nonce）は、一度しか使用できない任意の数字です。
  - 暗号化にはAES/CBC/PKCS5Pと256ビットのキーが使われ、毎日ローテーションされています。

- UID2 の暗号化タイムスタンプは、ペイロードのメタデータとして添付されます。

## Components

![Infrastructure](/images/key_mgmt.jpg)

### Administrator

分散したUID2システムへのアクセスを管理する集中サービスです。

#### Functions

- 暗号化キーとソルトをUID2 Operator配布します。

- UID2 Tokenの復号化に使用する復号化キーを、行動規範を遵守するメンバーに配布します。

- UID2 OperatorとDSPにUID2ユーザーのオプトアウト要求を送ります。

### Open Operators

UID2およびUID2 Tokenを生成・管理するサービスを（APIを介して）運営し、すべての参加者がアクセス可能な組織です。

UID2システムを構成するオペレーターは複数存在し、参加者はそのうちのいずれかのオペレーターを選択することも、Closed Operator（クローズドオペレーター 下記参照）になることもできます。

#### Functions

- UID2 Administrator サービスから暗号化キーとソルトを受け取り、保存します。

- 認証されたPIIをソルト化、ハッシュ化してUID2を返します。

- UID2を暗号化してUID2 Tokenを生成します。

- UID2 Tokenのアップデート（オプトアウトとソルトバケットローテーションの処理を含む）を、Refresh Tokenを使用してパブリッシャーにブロードキャストします。

### Closed Operators

UID2およびUID2 Tokenを生成・管理するために、独自の社内サービスを運営する組織。参加者は誰でもクローズドオペレーターになることができ、クラウドプロバイダーを介した複数のインテグレーションパスがあります。

#### Functions

- UID2 Administrator サービスから暗号化キーとソルトを受け取り、保存します。

- 認証されたPIIをソルト化、ハッシュ化してUID2を返します。

- UID2を暗号化してUID2 Tokenを生成します。

- UID2 Tokenのアップデート（オプトアウトとソルトバケットローテーションの処理を含む）を、Refresh Tokenを使用してパブリッシャーにブロードキャストします。

### Opt-Out Portal

ユーザー向けウェブサイト（ https://transparentadvertising.org/ ）で、ユーザーのUID2のオプトアウト機能を提供するサービスです。

#### Functions

- ユーザーのUID2に関する透明性を提供します。

- ユーザーがUID2をグローバルにオプトアウトする方法を提供し、オプトアウトすることによってすべてのUID2データ保有者にオプトアウト要求が出されます。

### UID2 Compliance Manager

この組織は、すべてのUID2参加者が規定のルールに準拠しているかどうかを監査します。

#### Functions

- 信頼たUID2エコシステムのメンバーを監査し、その遵守状況を確認します。

- コンプライアンス情報をUID2 AdministratorとUID2 Operatorに伝えます。

## Roles

UID2 参加者は、UID2 をどのように活用するかに基づいて、事前に定義された役割を選択する必要があります。役割は、特定のUID2参加者がUID2システムとどのように相互作用するかを決定します。また、その役割によって、行動規範の要件とそれに対応するコンプライアンスチェックが決まります。

UID2 参加者は複数の役割を果たすことができます。

**Generator:** 適切な同意を得た上で、メールアドレスや電話番号からUID2生成し、オプトアウトを履行する参加者。

Responsibilities:
- APIキーにアクセスするために、Administratorに登録します。
-	PIIからUID2.0を生成し、UID2.0を広告目的で使用することについて、顧客から同意を得ます。
-	顧客にオプトアウトポータルへのアクセスを提供し、UID2.0の同意を管理します。
-	Closed OperatorまたはOpen Operatorとの連携により、UID 2.0を生成します。
-	UID2のオプトアウトを履行します。
-	UID2 Tokenを常にリフレッシュします。

Examples: Publishers, Advertisers, Data Providers, Onboarders, Login Providers

**Observer:** GeneratorsからUID2を受け取り、保存し、広告のターゲティングおよび測定を目的として利用する参加者。

Responsibilites:
- APIキーにアクセスするために、Administratorに登録します。
-	顧客にオプトアウトポータルへのアクセスを提供し、UID2.0の同意を管理します。
-	UID2 decryption library.でUID2を復号します。
-	UID2のオプトアウトを履行します。

Examples: DSPs, Measurement Providers, Advertisers

## Workflow Summary

UID2エコシステムを構成する4つの主要なワークフローです。
1. [Buy-Side（バイサイド） Workflow](#buy-side-workflow)
2. [Data Provider（データプロバイダー） Workflow](#data-provider-workflow)
3. [Publisher（パブリッシャー） Workflow](#publisher-workflow)
4. [User Trust（ユーザートラスト） Workflow](#user-trust-workflow)

**Summary of Workflows**

![The UID2 Ecosystem](/images/macro_view.jpg)

以降のセクションでは、UID2プロセス全体における各ワークフローの位置づけを明らかにするために、各ワークフローを個別に説明します。

### Buy-Side Workflow

![Buy-Side（バイサイド）Workflow](/images/buy_side.jpg)

このワークフローは、ビッドストリームのUID2を対象に取引を行うDSPのためのものです。

#### Buy-Side (DSP) Workflow Overview

1. データプロバイダーは、ファーストパーティおよびサードパーティのデータを row UID2の形でDSPに渡します。
2. DSPはUID2 Administratorと同期し、復号鍵を受け取ります。
3. DSPは、ビッドストリームのUID2 Tokenにアクセスし、ビッド時に復号します。
4. DSPは、UID2管理者からのオプトアウト要求をモニターし、オプトアウトされたUID2の買い付けをブロックします。

#### Buy-Side Integration

DSPはUID2とインテグレーションすることで、ブランド（ファーストパーティデータとして）やデータプロバイダー（サードパーティデータとして）からUID2を受け取り、それらを利用してビッドストリーム内のUID2に対する入札情報として活用します。

##### Requirements

- UID2形式のデータを受け取ります。
- UID2の形式でデータを入札します。
- オプトアウト要求を満たすためのウェブフック（webhook）を構築します。
- 暗号化キーをUID2 Administratorと毎日同期します。

##### Optional
DSPが自身でメールアドレスからUID2を生成したい場合は、データプロバイダーワークフロー（下記参照）にも従います。

### Data Provider Workflow

![Data Provider（データプロバイダー） Workflow](/images/data_provider.jpg)

このワークフローは、ユーザーデータを収集し、それをDSPにプッシュする組織のためのものです。データコレクターには、広告主、データ・オンボーダー、計測プロバイダー、アイデンティティ・グラフ・プロバイダー、サードパーティ・データ・プロバイダー、およびDSPにデータをプッシュするその他組織が含まれます。

#### Data Provider Workflow Overview

1. データプロバイダは、ユーザーの同意を得た個人識別情報（PII）を UID2 Operatorに送信します。
2. UID2 Operatorは、raw UID2を生成して返します。
3. データプロバイダはUID2とソルトバケットを保管します。
    - Server-side: データプロバイダーはUID2をマッピングテーブル、DMP、データレイク、またはその他のサーバーサイドアプリケーションに格納します。
4. データプロバイダは行動規範で定められた許可されたトランスポートプロトコルを使用して、UID2 を DSP に送信します。
5. データプロバイダは UID2 Operatorをモニターし、必要に応じてソルトバケットのローテーションとUIDのアップデートを行います。

#### Data Provider Integration

認証されたPIIからUID2を生成するためには、データプロバイダーはUID2 Operator APIにアクセスする必要があります。広告主によっては、代わりにCDP、データオンボーダ、または他のサービスプロバイダを利用することを選択する場合があります。

##### Requirements

- UID2 Operatorとのインテグレーションを行い、UID2を生成し、ソルトバケットのローテーションを行います。

### Publisher Workflow

![Publisher（パブリッシャー） Workflow](/images/publisher_workflow.jpg)

このワークフローは、SSP を介して入札ストリームに ID を伝搬する組織のためのものです。この組織には、ID プロバイダー、パブリッシャー、および SSO が含まれます。

#### Publisher Workflow Overview

1. ユーザーがパブリッシャーのウェブサイト、モバイルアプリ、CTVアプリにアクセスします。
2. パブリッシャーは、オープンなインターネットの価値交換について説明し、ユーザーにログインを求めます。
3. ユーザーが認証されると、パブリッシャーはSDKまたは直接APIとインテグレーションして、ファーストパーティで認証されたPIIと対応するプライバシー設定をUID2 Operatorに送信します。パブリッシャーは、SSOプロバイダーやIDプロバイダーにPIIとプライバシー設定の受け渡しを代行させることができます。
4. UID2 Operatorは、ソルト、ハッシュ、暗号化の処理を行い、UID2 Tokenを返します。
5. パブリッシャーは、リアルタイムの入札時にSSPと共有するUID2 Tokenを保存します。
    a. Server-side: パブリッシャーは、トークンをマッピングテーブル、DMP、データレイク、その他のサーバーサイドアプリケーションに格納します。
    b. Client-side: パブリッシャーは、クライアントサイドのアプリやユーザーのブラウザに、ファーストパーティークッキーとしてトークンを保存します。
6. パブリッシャーは、インプレッション時にUID2 TokenをSSPに送信します。
7. SSP は UID2 Token使用して入札要求を行い、入札ストリームに取り込みます。
8. パブリッシャーはRefresh Tokenを使ってUID2 Tokenの更新をリクエストします。該当する場合、Refresh Tokenにはユーザーのオプトアウト要求が含まれています。

#### Publisher Integration

##### Publisher Direct Integration

認証されたPIIを送信し、UID2を生成することを希望するパブリッシャーは、UID2 Operator APIにアクセスする必要があります。

##### Requirements

- UID2 Operator APIとインテグレーションしてUID2 Tokenを生成します。
- Refresh Tokenを管理するか、UID2が提供するJavaScriptクライアントサイドSDKを使用します。
- UID2 TokenをSSPなどのインテグレーション先にに送信できるようにします。

##### Publisher Integration Through SSO or Identity Providers

パブリッシャーは、UID2 と相互運用可能な SSO または独立した ID プロバイダーと連携することを選択できます。プロバイダーはUID2のインテグレーションを代行することができます。

#### User Trust Workflow

![User Trust Workflow](/images/user_trust_workflow.jpg)

このワークフローは、パブリッシャーまたはパブリッシャーと関連する SSO および ID プロバイダに関わるユーザー向けです。このワークフローにより、ユーザーはUID2の作成に同意し、オプトアウト・ポータルでUID2の同意およびプライバシー設定を管理することができます。

#### User Trust Workflow Overview

1. ユーザーは、オプトアウトポータルにアクセスし、すべてのパブリッシャーのUID2をグローバルにオプトアウトすることができます。
2. オプトアウトのリクエストはUID2　Administratorに送られます。
3. UID2 Administrator、DSPにリクエストを配布します。
4. UID2 Operatorsは、Refresh Tokenを利用するパブリッシャーにリクエストを配布します。

## Frequently Asked Questions

### Identity

#### UID2保有者は、ソルトローテーションによるUID2の更新時期をどのように知ることができますか？

UID2 生成リクエストで提供されるメタデータには、UID2 の生成に使用されるソルトバケットが含まれます。ソルトバケットは永続的で、基礎となるPIIに割り当てられます。提供されている API を使用して、指定されたタイムスタンプ以降にローテーションしたソルトバケットを返します。ローテーションされたソルトバケットは、UID2保有者にどのUID2をリフレッシュすべきかを知らせます。このワークフローは通常、データプロバイダに適用されます。

#### UID2 Tokenの保有者は、リフレッシュのタイミングをどのように知ることができますか？

UID2 Tokenは、Refresh Tokenの一部として自動的に更新されます。このワークフローは通常、パブリッシャーとSSOに適用されます。

#### UID2 Tokenを扱う企業は、どの復号キーを適用すればよいかをどのように知ることができますか？

UID2 Tokenと一緒に提供されるメタデータには、暗号化のタイムスタンプが含まれ、どの復号鍵が適用されるかを示します。

### User Trust

#### ユーザーは自分のUID2に関連したターゲティング広告を拒否することができますか？

はい。オプトアウト・ポータルを通じて、ユーザーは自分のUID2に関連したターゲティング広告の提供を拒否することができます。このリクエストは、UID2 AdministratorおよびUID2 Operatorを通じて、関連するすべてのメンバーに配布されます。パブリッシャーやサービスプロバイダーの中には、ユーザーのUID2への参加状況に応じて自社製品へのアクセスを制限するオプションを持っているところもあり、ユーザーとの価値交換の対話の一環としてこれを伝えるのはパブリッシャーの責任です。

#### オプトアウト・ポータルへのアクセス方法はどうやって知ることができますか？

パブリッシャー、SSO、または同意管理プラットフォームは、ログイン/同意フロー、プライバシーポリシー、その他の手段でオプトアウトポータルへのリンクを開示します。

#### なぜ広告主やデータプロバイダーは、オプトアウト・フィードとインテグレーションする必要がないのですか？

オプトアウトとは、ターゲティング広告の配信停止に関するもので、パブリッシャーとDSPのオプトアウトワークフローによって処理されます。消費者が特定の広告主との契約を解除したい場合は、その広告主に直接連絡する必要があります。














## License
All work and artifacts are licensed under the Apache License, Version 2.0. See [LICENSE](http://www.apache.org/licenses/LICENSE-2.0.txt) for the full license text.
